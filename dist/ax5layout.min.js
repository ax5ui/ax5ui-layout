"use strict";!function(t,e){var i=ax5.util,o=function(){var t,o=this,n={mousedown:ax5.info.supportTouch?"touchstart":"mousedown",mousemove:ax5.info.supportTouch?"touchmove":"mousemove",mouseup:ax5.info.supportTouch?"touchend":"mouseup"},a=function(t){var e=t;return"changedTouches"in t&&(e=t.changedTouches[0]),{clientX:e.clientX,clientY:e.clientY}};e&&e.call(this),this.queue=[],this.config={theme:"default",animateTime:250,splitter:{size:5}},this.openTimer=null,this.closeTimer=null,this.resizer=null,t=this.config;var s=function(){for(var t=this.queue.length;t--;)"undefined"==typeof this.queue[t].parentQueIdx&&l.call(this,t)},l=function(){var e={top:function(e,i){i.$target.css({height:i.__height||0}),i.split&&i.$splitter.css({height:t.splitter.size,top:i.__height||0})},bottom:function(e,i){i.$target.css({height:i.__height||0}),i.split&&i.$splitter.css({height:t.splitter.size,bottom:i.__height||0})},left:function(e,i){var o={width:i.__width||0,height:e.targetDimension.height};e.dockPanel.top&&(o.height-=e.dockPanel.top.__height,o.top=e.dockPanel.top.__height,e.dockPanel.top.split&&(o.height-=t.splitter.size,o.top+=t.splitter.size)),e.dockPanel.bottom&&(o.height-=e.dockPanel.bottom.__height,e.dockPanel.bottom.split&&(o.height-=t.splitter.size)),i.$target.css(o),i.split&&i.$splitter.css({width:t.splitter.size,height:o.height,top:o.top,left:o.width})},right:function(e,i){var o={width:i.__width||0,height:e.targetDimension.height};e.dockPanel.top&&(o.height-=e.dockPanel.top.__height,o.top=e.dockPanel.top.__height,e.dockPanel.top.split&&(o.height-=t.splitter.size,o.top+=t.splitter.size)),e.dockPanel.bottom&&(o.height-=e.dockPanel.bottom.__height,e.dockPanel.bottom.split&&(o.height-=t.splitter.size)),i.$target.css(o),i.split&&i.$splitter.css({width:t.splitter.size,height:o.height,top:o.top,right:o.width})},center:function(e,i){var o={width:e.targetDimension.width,height:e.targetDimension.height};e.dockPanel.top&&(o.height-=e.dockPanel.top.__height||0,o.top=e.dockPanel.top.__height||0,e.dockPanel.top.split&&(o.height-=t.splitter.size,o.top+=t.splitter.size)),e.dockPanel.bottom&&(o.height-=e.dockPanel.bottom.__height||0,e.dockPanel.bottom.split&&(o.height-=t.splitter.size)),e.dockPanel.left&&(o.width-=e.dockPanel.left.__width||0,o.left=e.dockPanel.left.__width||0,e.dockPanel.left.split&&(o.width-=t.splitter.size,o.left+=t.splitter.size)),e.dockPanel.right&&(o.width-=e.dockPanel.right.__width||0,e.dockPanel.right.split&&(o.width-=t.splitter.size)),i.$target.css(o)}},i=function(t){for(var e=t.childQueIdxs.length;e--;)l.call(this,t.childQueIdxs[e])};return function(t,o){var n=this.queue[t];if(n.targetDimension={height:n.$target.innerHeight(),width:n.$target.innerWidth()},"dock-panel"==n.layout)for(var a in n.dockPanel)n.dockPanel[a].$target&&n.dockPanel[a].$target.get(0)&&a in e&&(n.dockPanel[a].split=n.dockPanel[a].split&&"true"==n.dockPanel[a].split.toString(),e[a].call(this,n,n.dockPanel[a]));n.childQueIdxs&&i.call(this,n),n.onResize&&setTimeout(function(){this.onResize.call(this,this)}.bind(n),1),o&&o.call(n,n)}}(),h={on:function(e,i){var a=this.queue[e],s=i.$splitter.offset(),l={width:i.$splitter.width(),height:i.$splitter.height()},r={left:function(e){if(i.__da=e.clientX-i.mousePosition.clientX,i.__width+i.__da<0)i.__da=-i.__width;else{var o=a.targetDimension.width-(a.dockPanel.left?a.dockPanel.left.__width+(a.dockPanel.left.split?t.splitter.size:0):0)-(a.dockPanel.right?a.dockPanel.right.__width+(a.dockPanel.right.split?t.splitter.size:0):0);o<i.__da&&(i.__da=o)}return{left:i.$splitter.offset().left+i.__da}},right:function(e){if(i.__da=e.clientX-i.mousePosition.clientX,i.__width-i.__da<0)i.__da=i.__width;else{var o=-a.targetDimension.width+(a.dockPanel.left?a.dockPanel.left.__width+(a.dockPanel.left.split?t.splitter.size:0):0)+(a.dockPanel.right?a.dockPanel.right.__width+(a.dockPanel.right.split?t.splitter.size:0):0);o>i.__da&&(i.__da=o)}return{left:i.$splitter.offset().left+i.__da}},top:function(e){if(i.__da=e.clientY-i.mousePosition.clientY,i.__height+i.__da<0)i.__da=-i.__height;else{var o=a.targetDimension.height-(a.dockPanel.top?a.dockPanel.top.__height+(a.dockPanel.top.split?t.splitter.size:0):0)-(a.dockPanel.bottom?a.dockPanel.bottom.__height+(a.dockPanel.bottom.split?t.splitter.size:0):0);o<i.__da&&(i.__da=o)}return{top:i.$splitter.offset().top+i.__da}},bottom:function(e){if(i.__da=e.clientY-i.mousePosition.clientY,i.__height-i.__da<0)i.__da=i.__height;else{var o=-a.targetDimension.height+(a.dockPanel.top?a.dockPanel.top.__height+(a.dockPanel.top.split?t.splitter.size:0):0)+(a.dockPanel.bottom?a.dockPanel.bottom.__height+(a.dockPanel.bottom.split?t.splitter.size:0):0);o>i.__da&&(i.__da=o)}return{top:i.$splitter.offset().top+i.__da}}};i.__da=0,jQuery(document.body).bind(n.mousemove+".ax5layout-"+this.instanceId,function(t){o.resizer||(o.resizer=jQuery('<div class="ax5layout-resizer panel-'+i.dock+'" ondragstart="return false;"></div>'),o.resizer.css({left:s.left,top:s.top,width:l.width,height:l.height}),a.$target.append(o.resizer)),o.resizer.css(r[i.dock](t))}).bind(n.mouseup+".ax5layout-"+this.instanceId,function(t){h.off.call(o,e,i)}).bind("mouseleave.ax5layout-"+this.instanceId,function(t){h.off.call(o,e,i)})},off:function(t,e){var i={"dock-panel":{left:function(t,e){e.__width+=e.__da},right:function(){e.__width-=e.__da},top:function(){e.__height+=e.__da},bottom:function(){e.__height-=e.__da}},"split-panel":{},"tab-panel":{}};o.resizer&&(o.resizer.remove(),o.resizer=null,i[this.queue[t].layout][e.dock].call(this,t,e),l.call(this,t)),jQuery(document.body).unbind(n.mousemove+".ax5layout-"+this.instanceId).unbind(n.mouseup+".ax5layout-"+this.instanceId).unbind("mouseleave.ax5layout-"+this.instanceId)}},r=function(){var t={"dock-panel":function(t){var e=this.queue[t],s=0;e.dockPanel={},e.$target.find(">[data-dock-panel]").each(function(){var l={};!function(t){i.isObject(t)&&!t.error&&(l=jQuery.extend(!0,l,t))}(i.parseJson(this.getAttribute("data-dock-panel"),!0)),"dock"in l&&(l.$target=jQuery(this),l.$target.addClass("dock-panel-"+l.dock),l.split&&"true"==l.split.toString()&&(l.$splitter=jQuery('<div class="dock-panel-splitter dock-panel-'+l.dock+'"></div>'),l.$splitter.bind(n.mousedown,function(e){l.mousePosition=a(e),h.on.call(o,t,l)}).bind("dragstart",function(t){return i.stopEvent(t),!1}),e.$target.append(l.$splitter),s=0),"top"==l.dock||"bottom"==l.dock?l.__height=l.height+s:l.__width=l.width+s,e.dockPanel[l.dock]=l)})}};return function(e){var i=this.queue[e];i.$target.parents("[data-ax5layout]").get(0)&&u.call(this,i.$target.parents("[data-ax5layout]").get(0),e),i.layout in t&&t[i.layout].call(this,e),l.call(this,e)}}(),d=function(t){return i.isString(t)||(t=jQuery(t).data("data-ax5layout-id")),i.isString(t)?i.search(this.queue,function(){return this.id==t}):void console.log(ax5.info.getError("ax5layout","402","getQueIdx"))},u=function(t,e){var o=i.isNumber(t)?t:d.call(this,t);this.queue[o].childQueIdxs||(this.queue[o].childQueIdxs=[]),this.queue[o].childQueIdxs.push(e),this.queue[e].parentQueIdx=o};this.init=function(){this.onStateChanged=t.onStateChanged,this.onClick=t.onClick,jQuery(window).bind("resize.ax5layout-"+this.instanceId,function(){s.call(this)}.bind(this))},this.bind=function(e){var o,n={};return e=jQuery.extend(!0,n,t,e),e.target?(e.$target=jQuery(e.target),e.id||(e.id=e.$target.data("data-ax5layout-id")),e.id||(e.id="ax5layout-"+ax5.getGuid(),e.$target.data("data-ax5layout-id",e.id)),e.name=e.$target.attr("data-ax5layout"),e.options&&(e.options=JSON.parse(JSON.stringify(e.options))),function(t){i.isObject(t)&&!t.error&&(e=jQuery.extend(!0,e,t))}(i.parseJson(e.$target.attr("data-config"),!0)),o=i.search(this.queue,function(){return this.id==e.id}),-1===o?(this.queue.push(e),r.call(this,this.queue.length-1)):(this.queue[o]=jQuery.extend(!0,{},this.queue[o],e),r.call(this,o)),n=null,o=null,this):(console.log(ax5.info.getError("ax5layout","401","bind")),this)},this.resize=function(t,e){var o=i.isNumber(t)?t:d.call(this,t);return-1===o?void console.log(ax5.info.getError("ax5layout","402","resize")):(l.call(this,o,e),this)},this.onResize=function(t,e){var o=i.isNumber(t)?t:d.call(this,t);return-1===o?void console.log(ax5.info.getError("ax5layout","402","onResize")):(this.queue[o].onResize=e,this)},this.main=function(){arguments&&i.isObject(arguments[0])?this.setConfig(arguments[0]):this.init()}.apply(this,arguments)};t.layout=function(){return i.isFunction(e)&&(o.prototype=new e),o}()}(ax5.ui,ax5.ui.root),ax5.ui.layout_instance=new ax5.ui.layout,jQuery.fn.ax5layout=function(){return function(t){if(ax5.util.isString(arguments[0])){var e=arguments[0];switch(e){case"resize":return ax5.ui.layout_instance.resize(this);case"onResize":return ax5.ui.layout_instance.onResize(this,arguments[1]);default:return this}}else"undefined"==typeof t&&(t={}),jQuery.each(this,function(){var e={target:this};t=jQuery.extend({},t,e),ax5.ui.layout_instance.bind(t)});return this}}();