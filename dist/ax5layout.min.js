"use strict";!function(){var t=ax5.ui,e=ax5.ui.root,i=ax5.util,n="ax5layout",a="0.2.1",o=function(){var t,o=this,s={mousedown:ax5.info.supportTouch?"touchstart":"mousedown",mousemove:ax5.info.supportTouch?"touchmove":"mousemove",mouseup:ax5.info.supportTouch?"touchend":"mouseup"},h=function(t){var e="changedTouches"in t.originalEvent?t.originalEvent.changedTouches[0]:t;return{clientX:e.clientX,clientY:e.clientY}};e&&e.call(this),this.name=n,this.version=a,this.instanceId=ax5.getGuid(),this.config={theme:"default",animateTime:250,splitter:{size:4},autoResize:!0},this.queue=[],this.openTimer=null,this.closeTimer=null,this.resizer=null,t=this.config;var l=function(){for(var t=this.queue.length;t--;)"undefined"==typeof this.queue[t].parentQueIdx&&this.queue[t].autoResize&&u.call(this,t,null,"windowResize")},r={width:function(e){return e?e.__width+(e.split?t.splitter.size:0):0},height:function(e){return e?e.__height+(e.split?t.splitter.size:0):0}},u=function(){var e={split:{vertical:function(e,i,n){i.splitter?i.__height=t.splitter.size:n==e.splitPanel.length-1&&0==e.splitPanel.asteriskLength?(i.height="*",i.__height=void 0,e.splitPanel.asteriskLength++):"*"==i.height&&e.splitPanel.asteriskLength++},horizontal:function(e,i,n){i.splitter?i.__width=t.splitter.size:n==e.splitPanel.length-1&&0==e.splitPanel.asteriskLength?(i.width="*",i.__width=void 0,e.splitPanel.asteriskLength++):"*"==i.width&&e.splitPanel.asteriskLength++}}},n={top:function(e,i){i.$target.css({height:i.__height||0}),i.split&&i.$splitter.css({height:t.splitter.size,top:i.__height||0})},bottom:function(e,i){i.$target.css({height:i.__height||0}),i.split&&i.$splitter.css({height:t.splitter.size,bottom:i.__height||0})},left:function(e,i){var n={width:i.__width||0,height:e.targetDimension.height};e.dockPanel.top&&(n.height-=e.dockPanel.top.__height,n.top=e.dockPanel.top.__height,e.dockPanel.top.split&&(n.height-=t.splitter.size,n.top+=t.splitter.size)),e.dockPanel.bottom&&(n.height-=e.dockPanel.bottom.__height,e.dockPanel.bottom.split&&(n.height-=t.splitter.size)),i.$target.css(n),i.split&&i.$splitter.css({width:t.splitter.size,height:n.height,top:n.top,left:n.width})},right:function(e,i){var n={width:i.__width||0,height:e.targetDimension.height};e.dockPanel.top&&(n.height-=e.dockPanel.top.__height,n.top=e.dockPanel.top.__height,e.dockPanel.top.split&&(n.height-=t.splitter.size,n.top+=t.splitter.size)),e.dockPanel.bottom&&(n.height-=e.dockPanel.bottom.__height,e.dockPanel.bottom.split&&(n.height-=t.splitter.size)),i.$target.css(n),i.split&&i.$splitter.css({width:t.splitter.size,height:n.height,top:n.top,right:n.width})},center:function(e,i){var n={width:e.targetDimension.width,height:e.targetDimension.height};e.dockPanel.top&&(n.height-=e.dockPanel.top.__height||0,n.top=e.dockPanel.top.__height||0,e.dockPanel.top.split&&(n.height-=t.splitter.size,n.top+=t.splitter.size)),e.dockPanel.bottom&&(n.height-=e.dockPanel.bottom.__height||0,e.dockPanel.bottom.split&&(n.height-=t.splitter.size)),e.dockPanel.left&&(n.width-=e.dockPanel.left.__width||0,n.left=e.dockPanel.left.__width||0,e.dockPanel.left.split&&(n.width-=t.splitter.size,n.left+=t.splitter.size)),e.dockPanel.right&&(n.width-=e.dockPanel.right.__width||0,e.dockPanel.right.split&&(n.width-=t.splitter.size));var a=i.minWidth||0,o=i.minHeight||0;n.width<a&&(n.width=a,e.$target.css({minWidth:a+r.width(e.dockPanel.left)+r.width(e.dockPanel.right)})),n.height<o&&(n.height=o,e.$target.css({minHeight:o+r.height(e.dockPanel.top)+r.height(e.dockPanel.bottom)})),i.$target.css(n)},split:{vertical:function(e,i,n,a,o){var s={},h=n?Number(e.splitPanel[n-1].offsetEnd):0;i.splitter?s.height=t.splitter.size:"*"!=i.height||"undefined"!=typeof i.__height&&!o?s.height=i.__height||0:s.height=i.__height=(e.targetDimension.height-a)/e.splitPanel.asteriskLength,s.top=h,i.offsetStart=h,i.offsetEnd=Number(h)+Number(s.height),i.$target.css(s)},horizontal:function(e,i,n,a,o){var s={},h=n?Number(e.splitPanel[n-1].offsetEnd):0;i.splitter?s.width=t.splitter.size:"*"!=i.width||"undefined"!=typeof i.__width&&!o?s.width=i.__width||0:s.width=i.__width=(e.targetDimension.width-a)/e.splitPanel.asteriskLength,s.left=h,i.offsetStart=h,i.offsetEnd=Number(h)+Number(s.width),i.$target.css(s)}}},a={"dock-panel":function(t){for(var e in t.dockPanel)t.dockPanel[e].$target&&t.dockPanel[e].$target.get(0)&&e in n&&n[e].call(this,t,t.dockPanel[e])},"split-panel":function(t,a){var o;t.splitPanel.asteriskLength=0,t.splitPanel.forEach(function(i,n){e.split[t.oriental].call(this,t,i,n)}),o="vertical"==t.oriental?i.sum(t.splitPanel,function(t){return"*"!=t.height?i.number(t.__height):void 0}):i.sum(t.splitPanel,function(t){return"*"!=t.width?i.number(t.__width):void 0}),t.splitPanel.forEach(function(e,i){n.split[t.oriental].call(this,t,e,i,o,a)})}},o=function(t){for(var e=t.childQueIdxs.length;e--;)u.call(this,t.childQueIdxs[e])};return function(t,e,i){var n=this.queue[t];n.targetDimension={height:n.$target.innerHeight(),width:n.$target.innerWidth()},n.layout in a&&a[n.layout].call(this,n,i),n.childQueIdxs&&o.call(this,n,i),n.onResize&&setTimeout(function(){this.onResize.call(this,this)}.bind(n),1),e&&e.call(n,n)}}(),d={on:function(t,e,i){var n=this.queue[t],a=i.position(),h={width:i.width(),height:i.height()},l={left:function(t){var i="changedTouches"in t.originalEvent?t.originalEvent.changedTouches[0]:t;e.__da=i.clientX-e.mousePosition.clientX;var a=e.minWidth||0,o=e.maxWidth||n.targetDimension.width-r.width(n.dockPanel.left)-r.width(n.dockPanel.right);return e.__width+e.__da<a?e.__da=-e.__width+a:o<e.__width+e.__da&&(e.__da=o-e.__width),{left:e.$splitter.position().left+e.__da}},right:function(t){var i="changedTouches"in t.originalEvent?t.originalEvent.changedTouches[0]:t;e.__da=i.clientX-e.mousePosition.clientX;var a=e.minWidth||0,o=e.maxWidth||n.targetDimension.width-r.width(n.dockPanel.left)-r.width(n.dockPanel.right);return e.__width-e.__da<a?e.__da=e.__width-a:o<e.__width-e.__da&&(e.__da=-o+e.__width),{left:e.$splitter.position().left+e.__da}},top:function(t){var i="changedTouches"in t.originalEvent?t.originalEvent.changedTouches[0]:t;e.__da=i.clientY-e.mousePosition.clientY;var a=e.minHeight||0,o=e.maxHeight||n.targetDimension.height-r.height(n.dockPanel.top)-r.height(n.dockPanel.bottom);return e.__height+e.__da<a?e.__da=-e.__height+a:o<e.__height+e.__da&&(e.__da=o-e.__height),{top:e.$splitter.position().top+e.__da}},bottom:function(t){var i="changedTouches"in t.originalEvent?t.originalEvent.changedTouches[0]:t;e.__da=i.clientY-e.mousePosition.clientY;var a=e.minHeight||0,o=e.maxHeight||n.targetDimension.height-r.height(n.dockPanel.top)-r.height(n.dockPanel.bottom);return e.__height-e.__da<a?e.__da=e.__height-a:o<e.__height-e.__da&&(e.__da=-o+e.__height),{top:e.$splitter.position().top+e.__da}},split:function(t){var i="changedTouches"in t.originalEvent?t.originalEvent.changedTouches[0]:t;if("vertical"==n.oriental){e.__da=i.clientY-e.mousePosition.clientY;var a=n.splitPanel[e.panelIndex-1],o=n.splitPanel[e.panelIndex+1],s=a.minHeight||0,h=o.minHeight||0;return e.offsetStart+e.__da<a.offsetStart+s?e.__da=a.offsetStart-e.offsetStart+s:e.offsetStart+e.__da>o.offsetEnd-h&&(e.__da=o.offsetEnd-e.offsetEnd-h),{top:e.$target.position().top+e.__da}}e.__da=i.clientX-e.mousePosition.clientX;var a=n.splitPanel[e.panelIndex-1],o=n.splitPanel[e.panelIndex+1],l=a.minWidth||0,r=o.minWidth||0;return e.offsetStart+e.__da<a.offsetStart+l?e.__da=a.offsetStart-e.offsetStart+l:e.offsetStart+e.__da>o.offsetEnd-r&&(e.__da=o.offsetEnd-e.offsetEnd-r),{left:Number(e.$target.position().left)+Number(e.__da)}}};e.__da=0,jQuery(document.body).bind(s.mousemove+".ax5layout-"+this.instanceId,function(t){o.resizer||(o.resizer=jQuery('<div class="ax5layout-resizer panel-'+e.resizerType+'" ondragstart="return false;"></div>'),o.resizer.css({left:a.left,top:a.top,width:h.width,height:h.height}),n.$target.append(o.resizer)),o.resizer.css(l[e.resizerType](t))}).bind(s.mouseup+".ax5layout-"+this.instanceId,function(n){d.off.call(o,t,e,i)}).bind("mouseleave.ax5layout-"+this.instanceId,function(n){d.off.call(o,t,e,i)}),jQuery(document.body).attr("unselectable","on").css("user-select","none").on("selectstart",!1)},off:function(t,e,i){var n=this.queue[t],a={"dock-panel":{left:function(t,e){e.__width+=e.__da},right:function(){e.__width-=e.__da},top:function(){e.__height+=e.__da},bottom:function(){e.__height-=e.__da}},"split-panel":{split:function(){"vertical"==n.oriental?(n.splitPanel[e.panelIndex-1].__height+=e.__da,n.splitPanel[e.panelIndex+1].__height-=e.__da):(n.splitPanel[e.panelIndex-1].__width+=e.__da,n.splitPanel[e.panelIndex+1].__width-=e.__da)}},"tab-panel":{}};o.resizer&&(o.resizer.remove(),o.resizer=null,a[this.queue[t].layout][e.resizerType].call(this,t,e),u.call(this,t)),jQuery(document.body).unbind(s.mousemove+".ax5layout-"+this.instanceId).unbind(s.mouseup+".ax5layout-"+this.instanceId).unbind("mouseleave.ax5layout-"+this.instanceId),jQuery(document.body).removeAttr("unselectable").css("user-select","auto").off("selectstart")}},c=function(){var t=function(t,e){return"*"==t?void 0:"%"==i.right(t,1)?e*i.number(t)/100:Number(t)},e={"dock-panel":function(e){var n=this.queue[e];n.dockPanel={},n.$target.find(">[data-dock-panel]").each(function(){var a={};!function(t){i.isObject(t)&&!t.error&&(a=jQuery.extend(!0,a,t))}(i.parseJson(this.getAttribute("data-dock-panel"),!0)),"dock"in a&&(a.$target=jQuery(this),a.$target.addClass("dock-panel-"+a.dock),(a.split=a.split&&"true"==a.split.toString())&&(a.$splitter=jQuery('<div data-splitter="" class="dock-panel-'+a.dock+'"></div>'),a.$splitter.bind(s.mousedown,function(t){a.mousePosition=h(t),d.on.call(o,e,a,a.$splitter)}).bind("dragstart",function(t){return i.stopEvent(t),!1}),n.$target.append(a.$splitter)),"top"==a.dock||"bottom"==a.dock?a.__height=t(a.height,n.targetDimension.height):a.__width=t(a.width,n.targetDimension.width),a.resizerType=a.dock,n.dockPanel[a.dock]=a)})},"split-panel":function(e){var n=this.queue[e];n.splitPanel=[],n.$target.find(">[data-split-panel], >[data-splitter]").each(function(a){var l={};!function(t){i.isObject(t)&&!t.error&&(l=jQuery.extend(!0,l,t))}(i.parseJson(this.getAttribute("data-split-panel")||this.getAttribute("data-splitter"),!0)),l.$target=jQuery(this),l.$target.addClass("split-panel-"+n.oriental),l.panelIndex=a,this.getAttribute("data-splitter")?(l.splitter=!0,l.$target.bind(s.mousedown,function(t){l.panelIndex>0&&l.panelIndex<n.splitPanel.length-1&&(l.mousePosition=h(t),d.on.call(o,e,l,l.$target))}).bind("dragstart",function(t){return i.stopEvent(t),!1}),l.resizerType="split"):"vertical"==n.oriental?l.__height=t(l.height,n.targetDimension.height):(n.oriental="horizontal",l.__width=t(l.width,n.targetDimension.width)),n.splitPanel.push(l)})}};return function(t){var i=this.queue[t];i.targetDimension={height:i.$target.innerHeight(),width:i.$target.innerWidth()},i.$target.parents("[data-ax5layout]").get(0)&&p.call(this,i.$target.parents("[data-ax5layout]").get(0),t),i.layout in e&&e[i.layout].call(this,t),u.call(this,t)}}(),g=function(t){return i.isString(t)||(t=jQuery(t).data("data-ax5layout-id")),i.isString(t)?i.search(this.queue,function(){return this.id==t}):void console.log(ax5.info.getError("ax5layout","402","getQueIdx"))},p=function(t,e){var n=i.isNumber(t)?t:g.call(this,t);this.queue[n].childQueIdxs||(this.queue[n].childQueIdxs=[]),this.queue[n].childQueIdxs.push(e),this.queue[e].parentQueIdx=n};this.init=function(){this.onStateChanged=t.onStateChanged,this.onClick=t.onClick,jQuery(window).bind("resize.ax5layout-"+this.instanceId,function(){l.call(this)}.bind(this))},this.bind=function(e){var n,a={};return e=jQuery.extend(!0,a,t,e),e.target?(e.$target=jQuery(e.target),e.id||(e.id=e.$target.data("data-ax5layout-id")),e.id||(e.id="ax5layout-"+ax5.getGuid(),e.$target.data("data-ax5layout-id",e.id)),e.name=e.$target.attr("data-ax5layout"),e.options&&(e.options=JSON.parse(JSON.stringify(e.options))),function(t){i.isObject(t)&&!t.error&&(e=jQuery.extend(!0,e,t))}(i.parseJson(e.$target.attr("data-config"),!0)),n=i.search(this.queue,function(){return this.id==e.id}),-1===n?(this.queue.push(e),c.call(this,this.queue.length-1)):(this.queue[n]=jQuery.extend(!0,{},this.queue[n],e),c.call(this,n)),a=null,n=null,this):(console.log(ax5.info.getError("ax5layout","401","bind")),this)},this.align=function(t,e){var n=i.isNumber(t)?t:g.call(this,t);return-1===n?void console.log(ax5.info.getError("ax5layout","402","align")):(u.call(this,n,null,e),this)},this.onResize=function(t,e){var n=i.isNumber(t)?t:g.call(this,t);return-1===n?void console.log(ax5.info.getError("ax5layout","402","onResize")):(this.queue[n].onResize=e,this)},this.resize=function(){var t={"dock-panel":function(t,e){["top","bottom","left","right"].forEach(function(n){e[n]&&t.dockPanel[n]&&("top"==n||"bottom"==n?t.dockPanel[n].__height=i.isObject(e[n])?e[n].height:e[n]:("left"==n||"right"==n)&&(t.dockPanel[n].__width=i.isObject(e[n])?e[n].width:e[n]))})},"split-panel":function(){},"tab-panel":function(){}};return function(e,n,a){var o=i.isNumber(e)?e:g.call(this,e);return-1===o?void console.log(ax5.info.getError("ax5layout","402","resize")):(t[this.queue[o].layout].call(this,this.queue[o],n),u.call(this,o,a),this)}}(),this.reset=function(){var t={"dock-panel":function(t){["top","bottom","left","right"].forEach(function(e){t.dockPanel[e]&&("top"==e||"bottom"==e?t.dockPanel[e].__height=t.dockPanel[e].height:("left"==e||"right"==e)&&(t.dockPanel[e].__width=t.dockPanel[e].width))})},"split-panel":function(){},"tab-panel":function(){}};return function(e,n){var a=i.isNumber(e)?e:g.call(this,e);return-1===a?void console.log(ax5.info.getError("ax5layout","402","reset")):(t[this.queue[a].layout].call(this,this.queue[a]),u.call(this,a,n),this)}}(),this.hide=function(){},this.main=function(){arguments&&i.isObject(arguments[0])?this.setConfig(arguments[0]):this.init()}.apply(this,arguments)};t.layout=function(){return i.isFunction(e)&&(o.prototype=new e),o}()}(),ax5.ui.layout_instance=new ax5.ui.layout,jQuery.fn.ax5layout=function(){return function(t){if(ax5.util.isString(arguments[0])){var e=arguments[0];switch(e){case"align":return ax5.ui.layout_instance.align(this,arguments[1],arguments[2]);case"resize":return ax5.ui.layout_instance.resize(this,arguments[1],arguments[2]);case"reset":return ax5.ui.layout_instance.reset(this,arguments[1]);case"hide":return ax5.ui.layout_instance.hide(this,arguments[1]);case"onResize":return ax5.ui.layout_instance.onResize(this,arguments[1]);default:return this}}else"undefined"==typeof t&&(t={}),jQuery.each(this,function(){var e={target:this};t=jQuery.extend({},t,e),ax5.ui.layout_instance.bind(t)});return this}}();